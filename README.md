# SiamMCF

Implementation in Python and Tensorflow of the tracker described in the paper
[*Multiple context features in siamese networks for visual object tracking*](http://thoth.inrialpes.fr/people/hmorimit/papers/VOT2018_Morimitsu_SiamMCF.pdf),
VOT 2018 - ECCVW.

**Note 1**: The code supports both Python 2 and 3. However, the results vary
depending on the Python version. We used Python 2.7 to generate the results
shown in the paper.

**Note 2**: The instructions in this guide are for bash in Linux. If you use another
environment, you may have to adapt them accordingly.

## Requirements

- [Python](https://www.python.org/) 2 or 3 (Tested on Python 2.7 and 3.6)
- [Tensorflow](https://www.tensorflow.org/) (Tested on tensofflow 1.4)
- [Matplotlib](https://matplotlib.org/)
- [Numpy](http://www.numpy.org/)
- [Pillow](https://pillow.readthedocs.io/)
- [Scipy](https://www.scipy.org/)

## Installation

1. If you do not have the requirements above, install them first, following the
    instructions provided by each package.

2. Clone this repository:
    ```bash
    git clone https://github.com/hmorimitsu/siam-mcf.git
    ```

    We will refer to the directory generated by the clone operation as
    `siam-mcf`. If you cloned the repository with another name, be sure to
    adapt the following instructions accordingly.

3. Download the trained checkpoint from
   [Google Drive](https://drive.google.com/open?id=12R-AsehIWpYJsv5uWvR5T4YiE2W8KMb6)
   or [Baidu Yun](https://pan.baidu.com/s/1jWgoIndPASuvQolgk5KSTA)
   and extract them to `siam-mcf/pretrained`. Your directories should look like the following:

   ```lang-none
   + siam-mcf/
     + pretrained/
       - siam_mcf.ckpt-50000.data-00000-of-00001
       - siam_mcf.ckpt-50000.index
       - siam_mcf.ckpt-50000.meta
   ```

4. Add a (symlink to a) dataset in VOT or OTB style in `siam-mcf/data`. 
   For example, supposing you added the vot16 dataset, your directories should
   look like the following:

   ```lang-none
   + siam-mcf/
     + data/
       + vot16/
         + bag/
         + ball1/
         ...
   ```

5. Run the evaluation script:

   ```bash
   cd siam-mcf
   python run_tracker_evaluation.py --dataset_name vot16 --save_bboxes --save_images
   ```

   The image and bounding box results will be saved in the directory
   `siam-mcf/results`. You can see the command line parameters accepted by
   the script by running:

   ```bash
   python run_tracker_evaluation.py -h
   ```

   Additional parameters can be changed in the JSON files in
   `siam-mcf/parameters`.

## Raw results

The raw results obtained in OTB13, OTB15, VOT16 and VOT17 datasets can be
downloaded from [Google Drive](https://drive.google.com/open?id=1YnrytUwPITETeVgQHZWuPcSDWM353N-l)
or [Baidu Yun](https://pan.baidu.com/s/1IWM9gkkdPwoShQ2dpxEQOA).

## References

If you find this work useful, please consider citing:

```bibtex
@inproceedings{morimitsu2018multiple,
  title={Multiple context features in siamese networks for visual object tracking},
  author={Morimitsu, Henrique},
  booktitle={ECCV 2018 Workshops},
  year={2018}
}
```

```bibtex
@inproceedings{bertinetto2016fully,
  title={Fully-convolutional siamese networks for object tracking},
  author={Bertinetto, Luca and Valmadre, Jack and Henriques, Jo{\~a}o F and Vedaldi, Andrea and Torr, Philip H S},
  booktitle={ECCV 2016 Workshops},
  pages={850--865},
  year={2016}
}
```

## License

This software includes third party open source software components from:
- SiamFC: [https://github.com/torrvision/siamfc-tf](https://github.com/torrvision/siamfc-tf),
- VOT-toolkit: [https://github.com/votchallenge/vot-toolkit](https://github.com/votchallenge/vot-toolkit).

Original code for SiamMCF is licensed under the BSD-3-Clause license ([LICENSE_siam_mcf.md](LICENSE_siam_mcf.md)).
Code modified from SiamFC may also be subject to their license ([LICENSE_siam_fc.md](LICENSE_siam_fc.md)).
Code from VOT toolkit in src/vot is licensed under the GPLv3 license([LICENSE_vot.md](LICENSE_vot.md)).

## Contact

If you have any questions or find any bugs in the code, please feel free to contact me at hmorimitsu@outlook.com.